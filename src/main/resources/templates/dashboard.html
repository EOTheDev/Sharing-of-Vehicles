<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- grafico -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.5.0/dist/chart.min.js" integrity="sha256-yz7K02nILYEeRDwEfzu/1zI9SpBKod/nLYMTFh7vszs=" crossorigin="anonymous"></script>
    <!-- bootstrap -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <!-- icone -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" integrity="sha512-iBBXm8fW90+nuLcSKlbmrPcLa0OT92xO1BIsZ+ywDWZCvqsWgccV3gFoRBv0z+8dLJgyAHIhR35VZc2oM/gI1w==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="/css/dashboard.css">
    <title>Prenotazioni attive</title>
</head>
<body class="container-fluid" >
    <!-- carico header con thymeleaf -->
    <header class="header" th:replace="html/nav" id="navbarContainer">
    </header>
    
        <h1 class="titoloPagina">La tua dashboard</span>, bentornato, <span th:text="${utente.nome}"></span>!
        </h1>
        <!-- <a href="/"><button class="btn delete"><i class="fas fa-home"></i></button></a> -->
        
        <!-- <header>
            <div class="row">
                <h2 class="col-6-lg" id="headerVis">Visualizza
                    <span id="pizzaBoy">
                        <!-- cosa visualizzo? TODO  <i class="fas fa-arrow-down"></i>
                    </h2>
            <select class="col-6-lg" id="visualizzo">
                <option value="-">
                    Seleziona
                </option>
                <option value="prenotazioni">
                    Prenotazioni
                </option>
                <option value="veicoli">
                    Veicoli
                </option>
                <option value="clienti">
                    Clienti
                </option>
            </select>
        </div> -->
    </header>    
    <main>
        <div class="row">
             <div class="col">
                 <!-- inizio accordion -->
                 <div class="accordion col-12" id="formPrenotazione">
                    <h2  class="col-12 accordion-header" id="headingTwo">
                        <button id="insAcc" class=" col-12 accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseFormAcc" aria-expanded="true" aria-controls="collapseTwo">
                            <span id="enterPrenotazione">Inserisci nuova prenotazione</span>
                        </button>
                 
                            <div id="collapseFormAcc" class="accordion-collapse collapse" aria-labelledby="headingTwo" data-bs-parent="#tableContainer">
                                    <div class="accordion-body accBody" id="formBody">
                                        <div class="casellaForm">
                                            <h3>id utente:</h3>
                                            <input type="number" class="form-control" id="idUtente" placeholder="id utente" required>
                                        </div>
                                        <div class="casellaForm">
                                            <h3>data:</h3>
                                            <input type="date" class="form-control" id="datePrenotazione" required>
                                        </div>
                                        <div class="casellaForm">
                                            <h3>id veicolo:</h3>
                                            <input type="number" class="form-control" id="idVeicolo" placeholder="id veicolo" required>
                                        </div>
                 
                                        <div class="casellaForm" style="padding: 0.5rem 0 0 0;">
                                            <input type="hidden" name="emailAdmin" th:value="${utente.email}">
                                            <button id="btn-ins-pre" class="btn edit"><i class="far fa-thumbs-up"></i> <h4>Inserisci</h4> </button>
                                        </div>
                                        <!-- </div> -->
                                    </div>
                                </div>
                            </div>
                    </h2>
                </div>
                <!-- fine accordion -->
                         <div class="col">
                             <!-- inizio accordion cliente -->
                             <div class="accordion col-12" id="formCliente">
                                             <h2  class="col-12 accordion-header" id="headingTwo">
                                                 <button id="insCli" class=" col-12 accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseInsCli" aria-expanded="true" aria-controls="collapseTwo">
                                <span id="enterCliente">Inserisci nuovo cliente</span>
                                                 </button>
                                <div id="collapseInsCli" class="accordion-collapse collapse" aria-labelledby="headingTwo" data-bs-parent="#tableContainer">
                                        <form class="accordion-body accBody" action="/dashboard/insert"  method="post" id="formBody">
                                            <div class="casellaForm">
                                                <h3>username:</h3>
                                                <input type="text" class="form-control" name="username" id="username" placeholder="username" required>
                                            </div>
                                            <div class="casellaForm">
                                                <h3>email:</h3>
                                                <input type="email" class="form-control" name="email" id="username" placeholder="username" required>
                                            </div>
                                            <div class="casellaForm">
                                                <h3>nome:</h3>
                                                <input type="text" class="form-control" name="nome" id="nome" placeholder="nome" required>
                                            </div>
                                            <div class="casellaForm">
                                                <h3>Cognome:</h3>
                                                <input type="text" class="form-control" name="cognome" id="cognome" placeholder="cognome" required>
                                            </div>
                                            <div class="casellaForm">
                                                <h3>data nascita:</h3>
                                                <input type="date" class="form-control" name="nascita" id="dateBirth" required>
                                            </div>
                                            <div class="casellaForm">
                                                <h3>amministratore:</h3>
                                                <select class="form-select" id="tipo" name="tipo" required>
                                                    <option value="B" >-</option>
                                                    <option value="A">Sì</option>
                                                    <option value="B">No</option>
                                                </select>
                                            </div>
                                            <div class="casellaForm" style="padding: 0.5rem 0 0 0;">
                                                <input type="hidden" name="emailAdmin" th:value="${utente.email}">
                                                <button id="btn-ins-cli" class="btn edit"><i class="far fa-thumbs-up"></i> <h4>Inserisci</h4> </button>
                                            </div>
                                            <!-- </div> -->
                                        </form>
                                    </div>
                                </div>
                                </h2>
                            </div>
                            <!-- fine accordion -->
                            <div class="col">
                                <!-- inizio accordion veicolo-->
                                <div class="accordion col-12" id="formVeicolo">
                                    <h2  class="col-12 accordion-header" id="headingTwo">
                                        <button id="insVei" class=" col-12 accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseInsVei" aria-expanded="true" aria-controls="collapseTwo">
                                            <span id="enterVeicolo">Inserisci nuovo veicolo</span>
                                        </button>
                                    </h2>
                                    <div id="collapseInsVei" class="accordion-collapse collapse" aria-labelledby="headingTwo" data-bs-parent="#tableContainer">
                                        <!-- FORM AGGIUNTA VEICOLO -->
                                        <form class="accordion-body accBody" action="/dashboard/addVeicolo" method="post" enctype="multipart/form-data" id="formBody">
                                            <div class="casellaForm">
                                                <h3>Nome veicolo:</h3>
                                                <input type="text" class="form-control" name="modello" id="username" placeholder="Modello" required>
                                            </div>
                                            <div class="casellaForm">
                                                <h3>Tipo veicolo:</h3>
                                                <select  class="form-select" name="tipologia" id="tipoVeicolo" required>
                                                    <option value="">-</option>
                                                    <option value="Auto">Automobile</option>
                                                    <option value="Monopattino">Monopattino</option>
                                                    <option value="Moto">Moto</option>
                                                    <option value="Bici">Bicicletta</option>
                                                </select>
                                            </div>
                                            <div class="casellaForm">
                                                <h3>Alimentazione:</h3>
                                                <select  class="form-select" name="alimentazione" id="alimentazione" required>
                                                    <option value="">-</option>
                                                    <option value="Benzina">Benzina</option>
                                                    <option value="Diesel">Diesel</option>
                                                    <option value="Ibrida">Ibrida</option>
                                                    <option value="Elettrica">Elettrica</option>
                                                    <option value="Human power">Human power</option>
                                                </select>
                                            </div>
                                            <div class="casellaForm">
                                                <h3>Colore:</h3>
                                                <select  class="form-select" name="colore" id="alimentazione" required>
                                                    <option value="">-</option>
                                                    <option value="#BBDEF0" style="background-color: #BBDEF0;">Azzurro</option>
                                                    <option value="#">Diesel</option>
                                                    <option value="#">Ibrida</option>
                                                    <option value="#">Elettrica</option>
                                                    <option value="#">Human power</option>
                                                </select>
                                            </div>
                                            <div class="casellaForm">
                                                <h3>Posizione:</h3>
                                                <input type="text" class="form-control" name="indirizzo" id="posizione" placeholder="Indirizzo" required>
                                            </div>
                                            <div class="casellaForm">
                                                <h3>Prezzo:</h3>
                                                <input type="text" class="form-control" name="prezzo" id="prezzo" placeholder="€uro" required>
                                            </div>
                                            <!-- <div class="casellaForm"> -->
                                                <div class="casellaForm">
                                                    <input type="file" class="form-control" name="imgUpl" accept="image/png" id="customFile">
                                                </div>
                                            <!-- </div> -->
                                            <div class="casellaForm" style="padding: 0.5rem 0 0 0;">
                                                <input type="hidden" name="utenteId" th:value="${utente.id}">
                                                <button id="btn-ins-vei" class="btn edit"><i class="far fa-thumbs-up"></i> <h4>Inserisci</h4> </button>
                                            </div>
                                            <!-- else sbagliato <i class="fas fa-times"></i> -->
                                        </div>
                                    </form>
                                </div>
                                
                            </div>
                        </div>
                    </div>
                    <!-- fine accordion -->
                </div>
            </div>
                
        <div class="container" id="tableContainer">
            
            <div class="table-responsive">
                <table class="table table-striped" id="prenotazioni">
                    <h3>Le tue prenotazioni</h3>
                    <tr>
                        <th>Referente</th>
                        <th>Numero prenotazione</th>
                        <th>Veicolo</th>
                        <th>Risparmio in CO2</th>
                        <th>Data</th>
                        <th>Tariffa</th>
                        <th>Interagisci</th>
                    </tr>
                    <tr th:each="prenotazione:${prenotazioni}">
                        <td><span id="nome" th:text="${prenotazione.utenteId.nome}">Mario</span> <span id="cognome" th:text="${prenotazione.utenteId.cognome}">Rossi</span></td>
                        <td><span id="idPrenotazione"  th:text="${prenotazione.id}">X1A14B33</span></td>
                        <td><span id="veicolo" th:text="${prenotazione.veicoloId.modello}">Bici</span></td>
                        <td><span id="pesoCO2" th:text="${prenotazione.veicoloId.pesoCo2}">0.8</span> g/m3</td>
                        <td><span id="giorno" th:text="${prenotazione.dataPrenotazione}">3</span></td>
                        <td><span id="tariffa" th:text="${prenotazione.veicoloId.prezzo}">10</span> €</td>
                        <td><button class="btn edit"><i class="fas fa-edit"></i></button> </i><button class="btn delete"><i class="fas fa-trash"></i></button></i></td>
                    </tr>
                </table>
            </div>
    
    
    
    
           <!--TABELLA CLIENTI -->
    
            <div class="table-responsive">
                <table class="table table-striped" id="clienti">
                    <h3>I tuoi clienti
                    </h3>
                    <tr>
                        <th>id
                </th>
                        <th>username</th>
                        <th>Ruolo</th>
                        <th>Nome</th>
                        <th>Cognome</th>
                        <th>Email</th>
                        <th>Data di Nascita</th>
                        <th>Data di iscrizione</th>
                        <!-- <th>Soldi spesi</th>
                        <th>Emissioni totali</th>
                        <th>Emissioni in percentuale</th> 
                    -->
                        <th>Interagisci</th> 
                    </tr>
                    <tr th:each="user:${listaUtenti}">
                        <td><span th:text="${user.id}" id="id">elDiablo23</span></td>
                        <td><span th:text="${user.username}" id="username">elDiablo23</span></td>
                        <td><span th:text="${user.tipo}" id="ruolo">elDiablo23</span></td>
                        <td><span th:text="${user.cognome}" id="cognome">Rossi</span></td>
                        <td><span th:text="${user.nome}" id="nome">Mario</span></td>
                        <td><span th:text="${user.email}" id="email">mariorossi@email.ru</span></td>
                        <td><span th:text="${user.nascita}" id="dataNascita">19</span></td>
                        <td><span th:text="${user.dataIscrizione}"id="iscrizione">16/12/2020</span></td>
                        <!--TODO <td><span id="totSpesaUtente">235,05</span> €</td>
                        <td><span id="totEmissioni">210</span> g/m3</td>
                        <td><span id="emissioniPercentuale">0.9</span> g/m3</td> -->
                        <td>
                
                        <form action="/dashboard/update" method="post">
                            <input type="hidden" name="emailAdmin" th:value="${utente.email}">
                
                            <input type="hidden" name="id" th:value="${user.id}">
                
                            <button class="btn edit" id="btnMod">
                                <i class="fas fa-edit"></i>
                            </button>
                            </form>
                
                
                            <form action="/dashboard/delete" method="post">
                            <input type="hidden" name="emailAdmin" th:value="${utente.email}">
                            <input type="hidden" name="id" th:value="${user.id}">
                                        <button class="btn delete" >
                                            <i class="fas fa-trash"></i>
                                        </button>
                            </form>
                        </td>
                    </tr>
                
                </table>
            </div>
            
    <!--   TABELLA VEICOLI -->
    
            <div class="table-responsive" style="max-width: 95vw;">
                <table class="table table-striped " id="veicoli">
                    <h3>I tuoi veicoli
                    </h3>
                    <tr>
                        <!--<th>id</th>  -->
                        <th>Tipo veicolo</th>
                        <th>Modello</th>
                        <th>Alimentazione</th>
                        <th>Descrizione</th>
                        <th>Ultima posizione</th>
                        <th>Url Immagine</th>
                        <th>Immagine</th>
                        <th>Tariffa</th>
                        <!-- <th>Incasso Totale</th> -->
                        <th>E/R per viaggio</th>
                        <th>Noleggiatore preferito</th>
                        <th>Interagisci</th>
                    </tr>
                    <tr th:each="veicolo:${veicoli}">
                        <!-- <td><span th:text="${veicolo.id}" id="idVeicolo">15</span></td> -->
                        <td><span th:text="${veicolo.tipologia}" id="tipologia">Bici</span></td>
                        <td><span th:text="${veicolo.modello}" id="modello">Bella</span></td>
                        <td><span th:text="${veicolo.alimentazione}" id="alimentazione">Human Power</span></td>
                        <td><span style="max-height: 4rem;" th:text="${veicolo.descrizione}"id="descrizione">Bici rossa raggiante, il mezzo più sostenibile che ci sia</span></td>
                        <td><span th:text="${veicolo.indirizzo}"id="posizione">via del Campo, 19, Torino</span></td>
                        <td><span th:text="${veicolo.immagine}"id="urlImmagine">questa immagine.png</span></td>
                        <td><img src="img/veicolo.jpg"  th:attr="src=@{'/imgUpl/'+${veicolo.id}+'/'+${veicolo.immagine}}" alt="immagine del veicolo" srcset=""></td>
                        <td><span th:text="${veicolo.prezzo}" id="tariffa">10</span> €/g</td>
                        <!-- <td><span id="incassoVeicolo">2500</span> €</td> -->
                        <td><span id="emissioniPercentuale" th:text="${veicolo.pesoCo2}">1</span> g/m3</td>
                        <td><span th:text="${veicolo.utenteId.username}" id="totEmissioni">25</span> g/m3</td>
                        <td><button class="btn edit"><i class="fas fa-edit"></i></button> </i><button class="btn delete"><i class="fas fa-trash"></i></button></i></td>
                    </tr>
                
                </table>
            </div>
        </div>
          

    </main>
    <footer class="footer" id="footerContainer"></footer>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.js" integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk=" crossorigin="anonymous"></script>
    <script th:inline="javascript"> 
      
        /* manteniamo il login*/
        var utente = [[${utente}]];
        console.log(utente);
    </script>
    <!-- aggiungo la navigazione -->
    <script src="/js/nav.js"></script>
</body>
</html>